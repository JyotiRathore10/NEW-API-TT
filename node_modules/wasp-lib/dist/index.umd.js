(function(i,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(i=typeof globalThis<"u"?globalThis:i||self,n(i.WaspLib={}))})(this,function(i){"use strict";var P=Object.defineProperty;var _=(i,n,l)=>n in i?P(i,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[n]=l;var c=(i,n,l)=>_(i,typeof n!="symbol"?n+"":n,l);function n(g,r,t){const e=g.slice(0,r);for(;e.length<r;)e.push(null);return e}const l=1,m=0,o={i8:Int8Array.BYTES_PER_ELEMENT,i16:Int16Array.BYTES_PER_ELEMENT,i32:Int32Array.BYTES_PER_ELEMENT,i64:BigInt64Array.BYTES_PER_ELEMENT,float:Float32Array.BYTES_PER_ELEMENT,double:Float64Array.BYTES_PER_ELEMENT};class h{constructor(r,t){c(this,"_ptr",0);c(this,"wasm");this.wasm=r,this._ptr=t}get ptr(){return this._ptr}get isValid(){return this._ptr!==0}validatePointer(){if(!this.isValid)throw new Error("Cannot operate on freed or invalid pointer")}free(){this._ptr!==0&&(this.wasm._free(this._ptr),this._ptr=0)}readAndFree(){this.validatePointer();const r=this.read();return this.free(),r}toString(){return`${this.constructor.name}(ptr=${this._ptr}, valid=${this.isValid})`}}class d extends h{constructor(t,e,s,a){super(t,a??t._malloc(s*o[e]));c(this,"type");c(this,"length");this.type=e,this.length=s}static from(t,e,s,a=[]){const T=d.alloc(t,e,s);return T.write(a),T}static alloc(t,e,s){return new d(t,e,s)}add(t,e){if(this.validatePointer(),t>=0&&t<this.length)this.wasm.setValue(this.ptr+t*o[this.type],e,this.type);else throw new Error(`Out-of-bounds access: tried to write at index ${t} in array of length ${this.length}`)}read(){this.validatePointer();const t=o[this.type],e=Array.from({length:this.length},(s,a)=>this.wasm.getValue(this.ptr+a*t,this.type));return n(e,this.length)}write(t){if(this.validatePointer(),t.length>this.length)throw new Error(`Array length mismatch. Expected ${this.length}, got ${t.length}`);t.forEach((e,s)=>this.add(s,e))}}class u{static boolToC(r){return r?l:m}static boolFromC(r){return!!r}static charToC(r){if(typeof r!="string"||r.length!==1)throw new Error("Input must be exactly one character");const t=r.charCodeAt(0);if(t<0||t>255)throw new Error(`Character '${r}' is outside ASCII range (0-255)`);return t}static charFromC(r){if(!Number.isInteger(r)||r<0||r>255)throw new Error(`Invalid ASCII code: ${r}. Must be 0-255`);return String.fromCharCode(r)}static validateNumberType(r){if(!(r in o))throw new Error(`Unsupported number type: ${r}`);return!0}static getTypeSize(r){return this.validateNumberType(r),o[r]}}class E extends h{constructor(r,t){super(r,t??r._malloc(o.i8)),t||this.write(!1)}static from(r,t){const e=E.alloc(r);return e.write(t),e}static alloc(r){return new E(r)}write(r){this.validatePointer();const t=u.boolToC(r);this.wasm.setValue(this.ptr,t,"i8")}read(){this.validatePointer();const r=this.wasm.getValue(this.ptr,"i8");return u.boolFromC(r)}}class f extends h{constructor(r,t){super(r,t??r._malloc(o.i8)),t||this.write("\0")}static from(r,t){if(t.length!==1)throw new Error("Input must be exactly one character");const e=f.alloc(r);return e.write(t),e}static alloc(r){return new f(r)}write(r){this.validatePointer();const t=u.charToC(r);this.wasm.setValue(this.ptr,t,"i8")}read(){this.validatePointer();const r=this.wasm.getValue(this.ptr,"i8");return u.charFromC(r)}}class y extends h{constructor(){super({},0)}read(){throw new Error("Cannot read from a NullPointer")}}class w extends h{constructor(t,e,s){super(t,s??t._malloc(o[e]));c(this,"type");this.type=e}static from(t,e,s){const a=w.alloc(t,e);return a.write(s),a}write(t){this.validatePointer(),this.add(t)}static alloc(t,e){return new w(t,e)}add(t){this.validatePointer(),this.wasm.setValue(this.ptr,t,this.type)}read(){return this.validatePointer(),this.wasm.getValue(this.ptr,this.type)}}class p extends h{constructor(t,e,s){super(t,s??t._malloc(e*o.i8));c(this,"length");this.length=e}static from(t,e,s=""){const a=p.alloc(t,e+1);return a.write(s),a}static alloc(t,e){return new p(t,e)}write(t){if(this.validatePointer(),t.length+1>this.length)throw new Error("String length exceeds buffer size");this.wasm.stringToUTF8(t,this.ptr,this.length)}read(){return this.validatePointer(),this.wasm.UTF8ToString(this.ptr,this.length)}}i.ArrayPointer=d,i.BasePointer=h,i.BoolPointer=E,i.C_FALSE=m,i.C_TRUE=l,i.C_TYPE_SIZES=o,i.CharPointer=f,i.NullPointer=y,i.NumberPointer=w,i.StringPointer=p,i.TypeConverter=u,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
