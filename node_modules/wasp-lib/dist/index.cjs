"use strict";var m=Object.defineProperty;var T=(a,r,t)=>r in a?m(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t;var o=(a,r,t)=>T(a,typeof r!="symbol"?r+"":r,t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function P(a,r,t){const e=a.slice(0,r);for(;e.length<r;)e.push(null);return e}const g=1,f=0,n={i8:Int8Array.BYTES_PER_ELEMENT,i16:Int16Array.BYTES_PER_ELEMENT,i32:Int32Array.BYTES_PER_ELEMENT,i64:BigInt64Array.BYTES_PER_ELEMENT,float:Float32Array.BYTES_PER_ELEMENT,double:Float64Array.BYTES_PER_ELEMENT};class l{constructor(r,t){o(this,"_ptr",0);o(this,"wasm");this.wasm=r,this._ptr=t}get ptr(){return this._ptr}get isValid(){return this._ptr!==0}validatePointer(){if(!this.isValid)throw new Error("Cannot operate on freed or invalid pointer")}free(){this._ptr!==0&&(this.wasm._free(this._ptr),this._ptr=0)}readAndFree(){this.validatePointer();const r=this.read();return this.free(),r}toString(){return`${this.constructor.name}(ptr=${this._ptr}, valid=${this.isValid})`}}class c extends l{constructor(t,e,i,s){super(t,s??t._malloc(i*n[e]));o(this,"type");o(this,"length");this.type=e,this.length=i}static from(t,e,i,s=[]){const p=c.alloc(t,e,i);return p.write(s),p}static alloc(t,e,i){return new c(t,e,i)}add(t,e){if(this.validatePointer(),t>=0&&t<this.length)this.wasm.setValue(this.ptr+t*n[this.type],e,this.type);else throw new Error(`Out-of-bounds access: tried to write at index ${t} in array of length ${this.length}`)}read(){this.validatePointer();const t=n[this.type],e=Array.from({length:this.length},(i,s)=>this.wasm.getValue(this.ptr+s*t,this.type));return P(e,this.length)}write(t){if(this.validatePointer(),t.length>this.length)throw new Error(`Array length mismatch. Expected ${this.length}, got ${t.length}`);t.forEach((e,i)=>this.add(i,e))}}class h{static boolToC(r){return r?g:f}static boolFromC(r){return!!r}static charToC(r){if(typeof r!="string"||r.length!==1)throw new Error("Input must be exactly one character");const t=r.charCodeAt(0);if(t<0||t>255)throw new Error(`Character '${r}' is outside ASCII range (0-255)`);return t}static charFromC(r){if(!Number.isInteger(r)||r<0||r>255)throw new Error(`Invalid ASCII code: ${r}. Must be 0-255`);return String.fromCharCode(r)}static validateNumberType(r){if(!(r in n))throw new Error(`Unsupported number type: ${r}`);return!0}static getTypeSize(r){return this.validateNumberType(r),n[r]}}class u extends l{constructor(r,t){super(r,t??r._malloc(n.i8)),t||this.write(!1)}static from(r,t){const e=u.alloc(r);return e.write(t),e}static alloc(r){return new u(r)}write(r){this.validatePointer();const t=h.boolToC(r);this.wasm.setValue(this.ptr,t,"i8")}read(){this.validatePointer();const r=this.wasm.getValue(this.ptr,"i8");return h.boolFromC(r)}}class d extends l{constructor(r,t){super(r,t??r._malloc(n.i8)),t||this.write("\0")}static from(r,t){if(t.length!==1)throw new Error("Input must be exactly one character");const e=d.alloc(r);return e.write(t),e}static alloc(r){return new d(r)}write(r){this.validatePointer();const t=h.charToC(r);this.wasm.setValue(this.ptr,t,"i8")}read(){this.validatePointer();const r=this.wasm.getValue(this.ptr,"i8");return h.charFromC(r)}}class y extends l{constructor(){super({},0)}read(){throw new Error("Cannot read from a NullPointer")}}class E extends l{constructor(t,e,i){super(t,i??t._malloc(n[e]));o(this,"type");this.type=e}static from(t,e,i){const s=E.alloc(t,e);return s.write(i),s}write(t){this.validatePointer(),this.add(t)}static alloc(t,e){return new E(t,e)}add(t){this.validatePointer(),this.wasm.setValue(this.ptr,t,this.type)}read(){return this.validatePointer(),this.wasm.getValue(this.ptr,this.type)}}class w extends l{constructor(t,e,i){super(t,i??t._malloc(e*n.i8));o(this,"length");this.length=e}static from(t,e,i=""){const s=w.alloc(t,e+1);return s.write(i),s}static alloc(t,e){return new w(t,e)}write(t){if(this.validatePointer(),t.length+1>this.length)throw new Error("String length exceeds buffer size");this.wasm.stringToUTF8(t,this.ptr,this.length)}read(){return this.validatePointer(),this.wasm.UTF8ToString(this.ptr,this.length)}}exports.ArrayPointer=c;exports.BasePointer=l;exports.BoolPointer=u;exports.C_FALSE=f;exports.C_TRUE=g;exports.C_TYPE_SIZES=n;exports.CharPointer=d;exports.NullPointer=y;exports.NumberPointer=E;exports.StringPointer=w;exports.TypeConverter=h;
//# sourceMappingURL=index.cjs.map
